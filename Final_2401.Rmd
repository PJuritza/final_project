---
title: 'Final Project: Cereals'
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown



```{r}
library(readr, warn.conflicts = F)
library(tidyverse, warn.conflicts = F)
library(dplyr, warn.conflicts = F)
library(ggplot2, warn.conflicts = F) 
cereal <- read_csv("DATA 2401/cereal.csv", na = "-1")
glimpse(cereal)
```
**Types of cereal: Hot vs Cold**
```{r message = FALSE, warning = FALSE}
cereal %>% 
  count(type)
```


**Ounces to Grams:**
```{r message = FALSE, warning = FALSE}
#Renaming and adjusting the columns 
cereal <- cereal %>% 
  mutate(weight_grams = round(weight*28.3495, digits = 0), weight_ounces = weight, rating = ceiling(rating)) %>% 
  subset(select = -weight)
cereal

```

**Which cereal has the highest calories per serving? Which cereals have the lowest calories per serving?**

```{r message = FALSE, warning = FALSE, fig.dim = c(16, 10)}

cereal %>%
  ggplot(aes(x = reorder(name, calories), y = calories))+
  geom_col() +
  coord_flip()+ 
  labs(title = "Calories per Serving", x = "Name", y= "Calories")
  
```


**Which has the highest protein per serving?**
```{r message = FALSE, warning = FALSE, fig.dim = c(15, 10)}
cereal %>% 
  select(name, calories, protein) %>% 
  arrange(desc(protein)) %>% 
  head(5)

cereal %>% 
  arrange(desc(protein)) %>% 
  ggplot(aes(x = protein, y = name, color = protein, fill = protein ))+
  geom_col() +
  labs(title = "Protein per Serving", x = "Protein", y= "Name")

```


**What is the relationship between sugar and calories?** 
```{r message = FALSE, warning = FALSE}
cereal %>% 
  ggplot(aes(x = calories, y = sugars)) +
  geom_point()+
  geom_smooth()+ 
  theme_get()+
  labs(title = "Sugar vs Calories", x = "Calories", y= "Sugar")
```

**Will high fiber cereals have lower calories per serving? ** 
```{r message = FALSE, warning = FALSE}

cereal %>% 
  ggplot(aes(x = calories, y = fiber, color= fiber)) +
  geom_smooth() +
  geom_point()+ 
  theme_get()+
  labs(title = "Fiber vs Calories", x = "Calories", y= "Fiber")

```

**Are there any keto-friendly cereals? Which are low-carb?** 
```{r message = FALSE, warning = FALSE, fig.dim = c(12, 10)}

cereal %>% 
  ggplot(aes(x = carbo, y = name, color = carbo, fill = carbo))+
  geom_col() +
  labs(title = "Carbohydrates per Serving", x = "Carbohydrates", y= "Name")
cereal %>% 
  select(name, calories, carbo) %>% 
  arrange(carbo) %>% 
  head(5)

```
**What affects the ratings? What elements of nutrition result in higher ratings?**

```{r message = FALSE, warning = FALSE, fig.dim = c(10, 10)}
par(mfrow=c(3,3))
plot(cereal$calories, cereal$rating,  
 xlab="Calories",
 ylab="Rating",
 main="Rating vs Calories")
abline(lm(cereal$rating~cereal$calories), col="red")

plot(cereal$fat, cereal$rating, 
 xlab="Fat",
 ylab="Rating",
 main="Rating vs Fat")
abline(lm(cereal$rating~cereal$fat), col="red")

plot(cereal$sodium, cereal$rating,
 xlab="Sodium",
 ylab="Rating",
 main="Rating vs Sodium")
abline(lm(cereal$rating~cereal$sodium), col="red")

plot(cereal$carbo, cereal$rating,
 xlab="Carbohydrates",
 ylab="Rating",
 main="Rating vs Carbohydrates")
abline(lm(cereal$rating~cereal$carbo), col="red")

plot(cereal$fiber, cereal$rating,
 xlab="Fiber",
 ylab="Rating",
 main="Rating vs Fiber")
abline(lm(cereal$rating~cereal$fiber), col="red")

plot(cereal$sugars, cereal$rating,
 xlab="Sugar",
 ylab="Rating",
 main="Rating vs Sugar")
abline(lm(cereal$rating~cereal$sugars), col="red")

plot(cereal$protein, cereal$rating,
 xlab="Protein",
 ylab="Rating",
 main="Rating vs Protein")
abline(lm(cereal$rating~cereal$protein), col="red")

plot(cereal$potass, cereal$rating,
 xlab="Potassium",
 ylab="Rating",
 main="Rating vs Potassium")
abline(lm(cereal$rating~cereal$potass), col="red")



```
**Which self display has the highest/lowest ratings?**

```{r, message = FALSE, warning = FALSE}
boxplot(cereal$rating~cereal$shelf,
 xlab="Shelf",
 ylab="Rating",
 main="Rating vs Shelf",
 col = rainbow(3))

```


**Based on the nutrition elements and ratings, the lower the sugar and calories the higher the rating. Will shelf 3 have lower calories and lower sugar? Will shelf 2 have higher calories and higher sugar? **


```{r,message = FALSE, warning = FALSE, fig.dim = c(12, 10)}
par(mfrow=c(2,2))
boxplot(cereal$sugars~cereal$shelf,
 xlab="Shelf",
 ylab="Sugars",
 main="Sugar vs Shelf",
 col = rainbow(3))

boxplot(cereal$calories~cereal$shelf,
 xlab="Shelf",
 ylab="Calories",
 main="Calories vs Shelf",
 col = rainbow(3))

```
**Which manufactures have the higher ratings? Will they also the once produing the low-sugar and low-calorie cereals?**

mfr: Manufacturer of cereal
A = American Home Food Products;
G = General Mills
K = Kelloggs
N = Nabisco
P = Post
Q = Quaker Oats
R = Ralston Purina

```{r message = FALSE, warning = FALSE, fig.dim = c(12, 10)}


par(mfrow=c(2,3))
boxplot(cereal$rating~cereal$mfr,
 xlab="Manufacture",
 ylab="Rating",
 main="Rating vs Manufacture",
 col = rainbow(7))


boxplot(cereal$sugars~cereal$mfr,
 xlab="Manufacture",
 ylab="Sugar",
 main="Sugar vs Manufacture",
 col = rainbow(7))


boxplot(cereal$calories~cereal$mfr,
 xlab="Manufacture",
 ylab="Calories",
 main="Calories vs Manufacture",
 col = rainbow(7))

```

## Summary






## Resources 

- 80 Cereals Dataset: https://www.kaggle.com/crawford/80-cereals
- Cheat Sheet Data Visualization with ggplot2 : https://ggplot2.tidyverse.org/
- How to plot, and how to plot multiple graphs:https://www.youtube.com/watch?v=Z3V4Pbxeahg
- Protein and its importance: https://www.youtube.com/watch?v=Fe5wHw3pnmY
- Ketogenic lifestyle: https://www.everydayhealth.com/diet-nutrition/ketogenic-diet/ , https://www.everydayhealth.com/ketogenic-diet/diet/types-targeted-keto-high-protein-keto-keto-cycling-more/
- More information on Fiber: https://www.hsph.harvard.edu/nutritionsource/carbohydrates/fiber/





